<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Sums of Monotone Functions</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Analytic Number Theory Course Notes">
<meta property="book:author" content="Zach Teitler">
<script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math"
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><link href="_static/pretext/css/pretext_search.css" rel="stylesheet" type="text/css">
<script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&amp;family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;family=Tinos:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/dejavu-serif" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Serif:opsz,wdth,wght@8..144,50..150,100..900&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wdth,wght@75..100,300..800&amp;display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
<link href="_static/pretext/css/pretext.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/shell_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/banner_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/navbar_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/toc_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/knowls_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/style_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/colors_blue_red.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/setcolors.css" rel="stylesheet" type="text/css">
</head>
<body id="analytic-number-theory-notes" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" class="logo-link" target="_blank" href=""></a><div class="title-container">
<h1 class="heading"><a href="analytic-number-theory-notes.html"><span class="title">Analytic Number Theory Course Notes:</span> <span class="subtitle">Math 507, Spring 2024, Boise State University</span></a></h1>
<p class="byline">Zach Teitler</p>
</div>
</div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"></span><span class="treebuttons"><a class="previous-button button" href="sec-big-o.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="ch-4-summation-formulas.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="ch-5-arithmetic-functions-2.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\bbN}{\mathbb N}
\newcommand{\bbZ}{\mathbb Z}
\newcommand{\bbQ}{\mathbb Q}
\newcommand{\bbR}{\mathbb R}
\newcommand{\bbC}{\mathbb C}
\newcommand{\Mid}{\mathrel{\Vert}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2"><ul class="structural contains-active toc-item-list">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-1-bertrands-postulate.html" class="internal"><span class="codenumber">1</span> <span class="title">Bertrand’s Postulate</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-bertrand-pnt.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Prime Number Theorem</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-bertrand-erdos-proof.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Erdős’s proof of Bertrand’s postulate</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-bertrand-corollaries.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Corollaries</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-bertrand-corollaries.html#sec-bertrand-corollaries-2" class="internal"><span class="codenumber">1.3.1</span> <span class="title">Primes between consecutive squares</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-bertrand-corollaries.html#sec-bertrand-corollaries-3" class="internal"><span class="codenumber">1.3.2</span> <span class="title">Pairs that add up to primes</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-bertrand-corollaries.html#sec-bertrand-corollaries-4" class="internal"><span class="codenumber">1.3.3</span> <span class="title">Explicit bounds for the PNT</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-2-arithmetic-functions-1.html" class="internal"><span class="codenumber">2</span> <span class="title">Arithmetic Functions I</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-af1-examples.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Examples of arithmetic functions</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-af1-multiplicative.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Multiplicative functions</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-af1-dirichlet-product.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Dirichlet product</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-af1-dirichlet-product.html#sec-af1-dirichlet-product-2" class="internal"><span class="codenumber">2.3.1</span> <span class="title">Basic properties of Dirichlet product</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-af1-dirichlet-product.html#sec-af1-dirichlet-product-3" class="internal"><span class="codenumber">2.3.2</span> <span class="title">Dirichlet product of multiplicative functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-af1-dirichlet-product.html#sec-af1-dirichlet-product-4" class="internal"><span class="codenumber">2.3.3</span> <span class="title">Explanation of Dirichlet product</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-af1-mobius-inversion.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Möbius inversion</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-af1-mobius-inversion.html#sec-af1-mobius-inversion-2" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Möbius function</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-af1-mobius-inversion.html#sec-af1-mobius-inversion-3" class="internal"><span class="codenumber">2.4.2</span> <span class="title">Möbius function and Dirichlet product</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-3-floor-function.html" class="internal"><span class="codenumber">3</span> <span class="title">Floor Function</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-elementary-properties.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Elementary properties of the floor function</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-hermite-identity.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Hermite’s Identity</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-hermite-applications.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Applications of Hermite’s Identity</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="ch-4-summation-formulas.html" class="internal"><span class="codenumber">4</span> <span class="title">Summation Formulas</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-big-o.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Big O Notation And Friends</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-big-o.html#sec-big-o-2" class="internal"><span class="codenumber">4.1.1</span> <span class="title">Big O Notation</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-big-o.html#sec-big-o-3" class="internal"><span class="codenumber">4.1.2</span> <span class="title">Little o Notation</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section active"><div class="toc-title-box"><a href="sec-sums-monotone.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Sums of Monotone Functions</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-5-arithmetic-functions-2.html" class="internal"><span class="codenumber">5</span> <span class="title">Arithmetic Functions II</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-average-order.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Average Order of Growth</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-average-order.html#sec-average-order-3" class="internal"><span class="codenumber">5.1.1</span> <span class="title">Average order of number of divisors</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-average-order.html#sec-average-order-4" class="internal"><span class="codenumber">5.1.2</span> <span class="title">Average order of sum of divisors</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-average-order.html#sec-average-order-5" class="internal"><span class="codenumber">5.1.3</span> <span class="title">Average order of Euler totient</span></a></div></li>
</ul>
</li></ul>
</li>
<li class="toc-item toc-backmatter">
<div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-references"><div class="toc-title-box"><a href="bibliography.html" class="internal"><span class="title">References</span></a></div></li>
<li class="toc-item toc-colophon"><div class="toc-title-box"><a href="backmatter-3.html" class="internal"><span class="title">Colophon</span></a></div></li>
</ul>
</li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-sums-monotone"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">4.2</span><span class="space"> </span><span class="title">Sums of Monotone Functions</span>
</h2>
<div class="para logical" id="sec-sums-monotone-2">
<div class="para">Our goal here is to compare sums with integrals,</div>
<div class="displaymath process-math">
\begin{equation*}
\sum_{y \lt n \leq x} f(n),
\qquad
\int_y^x f(t) dt\text{.}
\end{equation*}
</div>
<div class="para">In general these should be “close”: the integral represents the area under the graph of <span class="process-math">\(f\)</span> between <span class="process-math">\(y\)</span> and <span class="process-math">\(x\text{,}\)</span> while the sum represents the total area of a “histogram” with bars of width <span class="process-math">\(1\)</span> and height <span class="process-math">\(f(n)\text{.}\)</span> This is, roughly, a Riemann sum for the integral. In this section we’ll make this more precise.</div>
</div>
<article class="definition definition-like" id="sec-sums-monotone-3"><h3 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">4.2.1</span><span class="period">.</span>
</h3>Let <span class="process-math">\(I\)</span> be an interval and <span class="process-math">\(g : I \to \bbR\text{.}\)</span> <span class="process-math">\(g\)</span> is called <dfn class="terminology">monotone</dfn> on <span class="process-math">\(I\)</span> if it is either increasing or decreasing on <span class="process-math">\(I\text{.}\)</span> (This is meant non-strictly.) <span class="process-math">\(g\)</span> is called <dfn class="terminology">unimodal</dfn> on <span class="process-math">\(I\)</span> if there exists an <span class="process-math">\(x_0 \in I\)</span> such that <span class="process-math">\(g\)</span> is (non-strictly) increasing on <span class="process-math">\((-\infty,x_0] \cap I\)</span> and (non-strictly) decreasing on <span class="process-math">\([x_0,\infty) \cap I\text{.}\)</span></article><div class="para" id="sec-sums-monotone-4">By standard results in real analysis, every monotone function is integrable (even if it is not continuous). Likewise, every unimodal function is integrable. So, it makes sense to talk about the integrals in this context.</div>
<div class="para" id="sec-sums-monotone-5">The comparison between sum and integral is straightforward when the interval has integer endpoints:</div>
<article class="theorem theorem-like" id="sec-sums-monotone-6"><h3 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">4.2.2</span><span class="period">.</span>
</h3>If <span class="process-math">\(a\)</span> and <span class="process-math">\(b\)</span> are integers with <span class="process-math">\(a \lt b\)</span> and <span class="process-math">\(f\)</span> is (non-strictly) monotone on <span class="process-math">\([a,b]\text{,}\)</span> then<div class="displaymath process-math" id="sec-sums-monotone-6-1-6">
\begin{equation}
\min\{f(a),f(b)\} \leq \sum_{n=a}^b f(n) - \int_a^b f(t) dt \leq \max\{f(a),f(b)\}\text{.}\tag{4.2.1}
\end{equation}
</div></article><article class="proof" id="sec-sums-monotone-6-2"><h3 class="heading"><span class="type">Proof<span class="period">.</span></span></h3>
<div class="para logical" id="sec-sums-monotone-6-2-1">
<div class="para">First suppose <span class="process-math">\(f\)</span> is monotone increasing. The minimum on the left is <span class="process-math">\(f(a)\)</span> and the maximum on the right is <span class="process-math">\(f(b)\text{.}\)</span> For every integer <span class="process-math">\(a \leq n \lt b\)</span> and every real number <span class="process-math">\(t \in [n,n+1]\)</span> we have</div>
<div class="displaymath process-math">
\begin{equation*}
f(a) \leq f(n) \leq f(t) \leq f(n+1) \leq f(b)\text{.}
\end{equation*}
</div>
<div class="para">Therefore</div>
<div class="displaymath process-math">
\begin{equation*}
f(n) = \int_n^{n+1} f(n) dt \leq \int_n^{n+1} f(t) dt \leq \int_n^{n+1} f(n+1) dt = f(n+1)\text{.}
\end{equation*}
</div>
<div class="para">The first and last equalities are simply integrals of constant values over an interval of length <span class="process-math">\(1\text{.}\)</span>
</div>
</div> <div class="para logical" id="sec-sums-monotone-6-2-2">
<div class="para">Adding up these inequalities gives</div>
<div class="displaymath process-math">
\begin{equation*}
\int_a^b f(t) dt = \sum_{n=a}^{b-1} \int_n^{n+1} f(t) dt \leq \sum_{n=a}^{b-1} f(n+1)
= \sum_{n=a+1}^b f(n)\text{.}
\end{equation*}
</div>
<div class="para">Adding <span class="process-math">\(f(a)\)</span> to both sides and subtracting the integral to the right gives</div>
<div class="displaymath process-math">
\begin{equation*}
f(a) \leq \sum_{n=a}^b f(n) - \int_a^b f(t) dt\text{.}
\end{equation*}
</div>
<div class="para">The inequality <span class="process-math">\(\leq f(b)\)</span> is similar, as is the case that <span class="process-math">\(f\)</span> is decreasing instead of increasing (or, deduce the decreasing case by applying the increasing case to <span class="process-math">\(-f\)</span>).</div>
</div></article><div class="para" id="sec-sums-monotone-7">When the interval has arbitrary endpoints, we will obtain a similar comparison, although takes a bit more work.</div>
<div class="para" id="sec-sums-monotone-8">In the following statement, the textbook adds the condition <span class="process-math">\(y \lt \lfloor x \rfloor \text{.}\)</span> This seems unnecessary.</div>
<article class="theorem theorem-like" id="sec-sums-monotone-9"><h3 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">4.2.3</span><span class="period">.</span>
</h3>If <span class="process-math">\(x,y \in \bbR\)</span> with <span class="process-math">\(y \lt x\)</span> and <span class="process-math">\(f\)</span> is nonnegative and (non-strictly) monotone on <span class="process-math">\([y,x]\text{,}\)</span> then<div class="displaymath process-math" id="sec-sums-monotone-9-1-5">
\begin{equation}
\left| \sum_{y \lt n \leq x} f(n) - \int_y^x f(t) dt \right| \leq \max\{f(y),f(x)\}\text{.}\tag{4.2.2}
\end{equation}
</div></article><article class="proof" id="sec-sums-monotone-9-2"><h3 class="heading"><span class="type">Proof<span class="period">.</span></span></h3>
<div class="para" id="sec-sums-monotone-9-2-1">First, take the case <span class="process-math">\(y \geq \lfloor x \rfloor\text{.}\)</span> This means that there is no integer <span class="process-math">\(n\)</span> such that <span class="process-math">\(y \lt n \leq x\text{.}\)</span> Then the sum is empty, so its value is zero. At the same time, the interval <span class="process-math">\([y,x]\)</span> has width at most <span class="process-math">\(1\text{.}\)</span> So the value of the integral is less than or equal to the maximum value of <span class="process-math">\(f\)</span> on the interval; by monotonicity this is a value at an endpoint. So the claimed inequality holds in this case.</div> <div class="para" id="sec-sums-monotone-9-2-2">Now suppose <span class="process-math">\(y \lt \lfloor x \rfloor\text{,}\)</span> so there is at least one integer <span class="process-math">\(n\)</span> such that <span class="process-math">\(y \lt n \leq x\text{.}\)</span> Suppose that <span class="process-math">\(f\)</span> is (non-strictly) increasing. We will compare the integral <span class="process-math">\(\int_y^x f(t) dt\)</span> with the sum <span class="process-math">\(\sum_{y \lt n \leq x} f(n)\text{.}\)</span> This is not precisely a Riemann sum for the integral, but it is close. Let us regard the sum as being equal to the total area of the following figure: for each integer <span class="process-math">\(n\)</span> with <span class="process-math">\(y \lt n \leq x\text{,}\)</span> we take the rectangle whose base is the interval from <span class="process-math">\(n-1\)</span> to <span class="process-math">\(n\)</span> on the horizontal axis, and whose height is equal to <span class="process-math">\(f(n)\text{;}\)</span> i.e., the right-hand endpoint of the base interval. So, this is something like a right-hand Riemann sum. It is not precisely a Riemann sum because the first interval may extend to the left of <span class="process-math">\(y\text{,}\)</span> and the last interval (ending at <span class="process-math">\(\lfloor x \rfloor\)</span>) may end to the left of <span class="process-math">\(x\text{.}\)</span>
</div> <div class="para" id="sec-sums-monotone-9-2-3">So, this sum (that is, the total area of the rectangles) differs from the integral (the total area under the graph of <span class="process-math">\(f\)</span>) in three ways. First, in each interval <span class="process-math">\([n-1,n]\)</span> the rectangle extends above the graph. This is because the function <span class="process-math">\(f\)</span> is increasing, and the rectangle’s height is given by the height of the right-hand endpoint, ie., the highest endpoint on that interval. So, each rectangle includes a “triangle” region on top of the graph. Second, the leftmost rectangle includes a vertical strip over the base <span class="process-math">\([\lfloor y \rfloor, y]\)</span> that is not included in the integral. Third, in contrast, the integral includes a vertical strip of area over the base <span class="process-math">\([\lfloor x \rfloor, x]\)</span> which is not covered by any rectangle.</div> <div class="para" id="sec-sums-monotone-9-2-4">First consider the area covered by the rectangles but not the integral. These are the first and second types of error in the previous paragraph. We claim this adds up to at most <span class="process-math">\(f(x)\text{.}\)</span> This is because the “error regions” in each rectangle are at disjoint heights: in the rectangle over base <span class="process-math">\([n-1,n]\text{,}\)</span> the “error region” is in heights <span class="process-math">\(f(n-1)\)</span> to <span class="process-math">\(f(n)\text{.}\)</span> Here, the leftmost strip is an exception, as it may include an “error region” going down to height <span class="process-math">\(0\text{.}\)</span> Still, if we horizontally slide these regions into one single strip, they will not overlap. Therefore their total area is at most the width of that strip (which is <span class="process-math">\(1\)</span>) times the height of that strip, which is <span class="process-math">\(f(\lfloor x \rfloor)\text{,}\)</span> the greatest height of any rectangle involved in the sum. So the total of these errors is at most <span class="process-math">\(f(\lfloor x \rfloor)\text{.}\)</span> This is less than or equal to <span class="process-math">\(f(x)\text{.}\)</span>
</div> <div class="para" id="sec-sums-monotone-9-2-5">Next consider the area covered by the integral but not the rectangles. This is the vertical strip on the right of the region, over the base <span class="process-math">\([\lfloor x \rfloor, x]\text{.}\)</span> This is contained in a rectangle with that same base, and height <span class="process-math">\(f(x)\text{.}\)</span> The width of that base is at most <span class="process-math">\(1\text{.}\)</span> So, the area of this rectangle is at most <span class="process-math">\(f(x)\text{.}\)</span> And then, the error from this source is at most <span class="process-math">\(f(x)\text{.}\)</span>
</div> <div class="para logical" id="sec-sums-monotone-9-2-6">
<div class="para">Now, the total error, the difference between the sum and the integral, is the <em class="emphasis">difference</em> of these separate errors, namely, the errors counting area in the rectangles but not the integral, and the errors counting area in the integral but not the rectangles. Since each type of error separately is at most <span class="process-math">\(f(x)\)</span> (and each of them is nonnegative), then their difference has magnitude at most <span class="process-math">\(f(x)\text{.}\)</span> In other words, we have</div>
<div class="displaymath process-math">
\begin{equation*}
\left| \sum_{y \lt n \leq x} f(n) - \int_y^x f(t) dt \right| \leq f(x) = \max\{f(y),f(x)\}
\end{equation*}
</div>
<div class="para">as claimed.</div>
</div> <div class="para" id="sec-sums-monotone-9-2-7">What remains is to show the other case, if <span class="process-math">\(f\)</span> is decreasing. This follows similarly (using the left-hand sum).</div></article><article class="corollary theorem-like" id="sec-sums-monotone-10"><h3 class="heading">
<span class="type">Corollary</span><span class="space"> </span><span class="codenumber">4.2.4</span><span class="period">.</span>
</h3>If <span class="process-math">\(y \in \bbR\)</span> and <span class="process-math">\(f\)</span> is nonnegative and monotone on <span class="process-math">\([y,\infty)\text{,}\)</span> then<div class="displaymath process-math" id="sec-sums-monotone-10-1-4">
\begin{equation}
\sum_{y \lt n \leq x} f(n) = \int_y^x f(t) dt + O(\max\{f(y),f(x)\})\text{.}\tag{4.2.3}
\end{equation}
</div>
<article class="remark remark-like" id="sec-sums-monotone-10-2"><h4 class="heading">
<span class="type">Remark</span><span class="space"> </span><span class="codenumber">4.2.5</span><span class="period">.</span>
</h4>
<div class="para" id="sec-sums-monotone-10-2-1">I believe the intention here is to regard <span class="process-math">\(y\)</span> as a fixed number, and everything else as a function of <span class="process-math">\(x\text{.}\)</span> The sum and the integral are functions of <span class="process-math">\(x\)</span> explicitly. If <span class="process-math">\(f\)</span> is increasing, then <span class="process-math">\(O(\max\{f(y),f(x)\}) = O(f(x)) = O(f)\text{.}\)</span> If <span class="process-math">\(f\)</span> is decreasing, then <span class="process-math">\(O(\max\{f(y),f(x)\}) = O(f(y)) = O(1)\text{.}\)</span>
</div></article></article><article class="proof" id="sec-sums-monotone-10-3"><h3 class="heading"><span class="type">Proof<span class="period">.</span></span></h3>We have seen that<div class="displaymath process-math" id="sec-sums-monotone-10-3-1">
\begin{equation}
\left| \sum_{y \lt n \leq x} f(n) - \int_y^x f(t)dt \right| \leq \max\{f(y),f(x)\}\tag{4.2.4}
\end{equation}
</div>for all <span class="process-math">\(x \gt y\text{.}\)</span> So<div class="displaymath process-math">
\begin{equation*}
\sum_{y \lt n \leq x} f(n) - \int_y^x f(t)dt = c(x) \max\{f(y),f(x)\}
\end{equation*}
</div>where <span class="process-math">\(-1 \leq c(x) \leq 1\text{;}\)</span> this is <span class="process-math">\(O(\max\{f(y),f(x)\})\text{.}\)</span></article><article class="corollary theorem-like" id="sec-sums-monotone-11"><h3 class="heading">
<span class="type">Corollary</span><span class="space"> </span><span class="codenumber">4.2.6</span><span class="period">.</span>
</h3>If <span class="process-math">\(f\)</span> is nonnegative and unimodal on <span class="process-math">\([1,\infty)\)</span> then<div class="displaymath process-math" id="sec-sums-monotone-11-1-3">
\begin{equation}
\sum_{n \leq x} f(n) = \int_1^x f(t)dt + O(1)\text{.}\tag{4.2.5}
\end{equation}
</div>
<article class="remark remark-like" id="sec-sums-monotone-11-2"><h4 class="heading">
<span class="type">Remark</span><span class="space"> </span><span class="codenumber">4.2.7</span><span class="period">.</span>
</h4>
<div class="para" id="sec-sums-monotone-11-2-1">The book says that <span class="process-math">\(f\)</span> should be unimodal on <span class="process-math">\([1,x]\text{.}\)</span> But requiring <span class="process-math">\(f\)</span> to be unimodal on <span class="process-math">\([1,x]\)</span> for all <span class="process-math">\(x \gt 1\)</span> is equivalent to requiring <span class="process-math">\(f\)</span> to be unimodal on <span class="process-math">\([1,\infty)\)</span> (exercise). And it must be intended to require unimodality for all <span class="process-math">\(x\text{;}\)</span> we can require <span class="process-math">\(f\)</span> to be unimodal on <span class="process-math">\([1,x]\)</span> for a particular <span class="process-math">\(x\text{,}\)</span> but then “<span class="process-math">\(O(1)\)</span>” doesn’t make sense.</div></article></article><article class="proof" id="sec-sums-monotone-11-3"><h3 class="heading"><span class="type">Proof<span class="period">.</span></span></h3>Say <span class="process-math">\(f\)</span> is increasing for <span class="process-math">\(x \lt x_0\)</span> and decreasing for <span class="process-math">\(x \gt x_0\text{.}\)</span> Then for <span class="process-math">\(x \gt x_0\)</span> we have<div class="displaymath process-math" id="sec-sums-monotone-11-3-5">
\begin{align*}
\left| \sum_{n \leq x} f(n) - \int_1^x f(t)dt \right|
\amp \leq \left| f(1) + \sum_{1 \lt n \leq x_0} f(n) - \int_1^{x_0} f(t)dt \right| \\
\amp \quad + \left| \sum_{x_0 \lt n \leq x} f(n) - \int_{x_0}^x f(t)dt \right| \\
\amp \leq f(1) + \max\{f(1),f(x_0)\} + \max\{f(x_0),f(x)\} \\
\amp = f(1) + 2 f(x_0) \text{.}
\end{align*}
</div>This is bounded, hence <span class="process-math">\(O(1)\text{.}\)</span></article><article class="example example-like" id="sec-sums-monotone-12"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">4.2.8</span><span class="period">.</span>
</h3>
<div class="para logical" id="sec-sums-monotone-12-1">
<div class="para">Let <span class="process-math">\(\alpha \geq 0\text{.}\)</span> Then:</div>
<div class="displaymath process-math" id="sec-sums-monotone-12-1-2">
\begin{equation}
\sum_{n \leq x} n^\alpha = \frac{x^{\alpha+1}}{\alpha+1} + O(x^\alpha)\text{.}\tag{4.2.6}
\end{equation}
</div>
<div class="para">Indeed,</div>
<div class="displaymath process-math">
\begin{equation*}
\sum_{n \leq x} n^\alpha = \int_1^x t^\alpha dt + O(\max\{1^\alpha,x^\alpha\})\text{.}
\end{equation*}
</div>
</div></article><article class="example example-like" id="sec-sums-monotone-13"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">4.2.9</span><span class="period">.</span>
</h3>
<div class="para logical" id="sec-sums-monotone-13-1">
<div class="para">For <span class="process-math">\(\alpha \gt 0\text{,}\)</span> <span class="process-math">\(\alpha \neq 1\text{,}\)</span> we have</div>
<div class="displaymath process-math" id="sec-sums-monotone-13-1-3">
\begin{equation}
\sum_{n \leq x} \frac{1}{n^\alpha} = \frac{x^{-\alpha+1}}{-\alpha+1} + O(1)\text{.}\tag{4.2.7}
\end{equation}
</div>
<div class="para">Indeed,</div>
<div class="displaymath process-math">
\begin{equation*}
\sum_{n \leq x} \frac{1}{n^\alpha} = \int_1^x \frac{1}{t^\alpha} dt + O(\max\{1/1^\alpha,1/x^\alpha\})\text{.}
\end{equation*}
</div>
<div class="para">The maximum on the right is <span class="process-math">\(O(1)\text{.}\)</span> Evaluating the integral gives the result.</div>
</div></article><article class="example example-like" id="sec-sums-monotone-14"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">4.2.10</span><span class="period">.</span>
</h3>
<div class="para logical" id="sec-sums-monotone-14-1">
<div class="para">Let <span class="process-math">\(\alpha \gt 1\text{.}\)</span> Then:</div>
<div class="displaymath process-math" id="sec-sums-monotone-14-1-2">
\begin{equation}
\sum_{n \gt x} \frac{1}{n^\alpha} = O(x^{-\alpha + 1})\text{.}\tag{4.2.8}
\end{equation}
</div>
<div class="para">Exercise.</div>
</div> <div class="para logical" id="sec-sums-monotone-14-2">
<div class="para">We have</div>
<div class="displaymath process-math" id="sec-sums-monotone-14-2-1">
\begin{equation}
\sum_{n \leq x} \frac{1}{n} = \log x + O(1)\tag{4.2.9}
\end{equation}
</div>
<div class="para">Exercise.</div>
</div> <div class="para logical" id="sec-sums-monotone-14-3">
<div class="para">We have</div>
<div class="displaymath process-math" id="sec-sums-monotone-14-3-1">
\begin{equation}
\sum_{n \leq x} \log n = x \log x - x + O(\log x)\text{.}\tag{4.2.10}
\end{equation}
</div>
<div class="para">Exercise.</div>
</div> <div class="para logical" id="sec-sums-monotone-14-4">
<div class="para">Let <span class="process-math">\(\alpha \geq 0\text{.}\)</span> Then:</div>
<div class="displaymath process-math" id="sec-sums-monotone-14-4-2">
\begin{equation}
\sum_{n \leq x} n^\alpha \log n
= \frac{x^{\alpha+1}}{\alpha+1} \left( \log x - \frac{1}{\alpha+1} \right)
+ O(x^\alpha \log x)\text{.}\tag{4.2.11}
\end{equation}
</div>
<div class="para">Exercise.</div>
</div></article></section></div>
<div class="ptx-content-footer">
<a class="previous-button button" href="sec-big-o.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="ch-5-arithmetic-functions-2.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="338 3000 8772 6866"><g style="stroke-width:.025in; stroke:black; fill:none"><polyline points="472,3590 472,9732 " style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png"></a>
</div>
</body>
</html>
